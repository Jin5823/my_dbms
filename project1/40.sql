select temp2.hometown as hometown, nickname from (select hometown, max(level) as maxlevel from Trainer as t1 inner join CatchedPokemon as cp1 on t1.id = cp1.owner_id group by hometown) as temp1 inner join (select hometown, level, nickname from Trainer as t1 inner join CatchedPokemon as cp1 on t1.id = cp1.owner_id) as temp2 on temp1.maxlevel=temp2.level and temp1.hometown=temp2.hometown order by hometown asc;
